{"ast":null,"code":"import axios from 'axios';\nimport { getAuth } from 'firebase/auth';\n\n// Create a custom debug function that can be toggled\nconst debug = process.env.NODE_ENV === 'development' ? (...args) => console.log('[API]', ...args) : () => {};\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5002/api',\n  withCredentials: true,\n  timeout: 10000,\n  // 10 second timeout\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n    'Cache-Control': 'no-cache',\n    'Pragma': 'no-cache',\n    'Expires': '0'\n  }\n});\n\n// Request interceptor for API calls\napi.interceptors.request.use(async config => {\n  var _config$method;\n  debug(`[${(_config$method = config.method) === null || _config$method === void 0 ? void 0 : _config$method.toUpperCase()}]`, config.url);\n  try {\n    const auth = getAuth();\n    if (auth.currentUser) {\n      try {\n        const token = await auth.currentUser.getIdToken(true);\n        if (token) {\n          config.headers.Authorization = `Bearer ${token}`;\n          debug('Added auth token to request');\n        }\n      } catch (tokenError) {\n        debug('Error getting auth token:', tokenError);\n        // Don't block the request if token refresh fails\n      }\n    } else {\n      debug('No current user, making unauthenticated request');\n    }\n    return config;\n  } catch (error) {\n    debug('Request interceptor error:', error);\n    return Promise.reject(error);\n  }\n}, error => {\n  debug('Request interceptor error (handler):', error);\n  return Promise.reject(error);\n});\n\n// Response interceptor for API calls\napi.interceptors.response.use(response => {\n  var _response$config$meth;\n  debug(`[${response.status}] ${(_response$config$meth = response.config.method) === null || _response$config$meth === void 0 ? void 0 : _response$config$meth.toUpperCase()} ${response.config.url}`, {\n    data: response.data,\n    headers: response.headers\n  });\n  return response;\n}, error => {\n  var _error$config, _error$config2, _error$response, _error$response2, _error$response3, _error$config3, _error$config4, _error$response4, _error$response5, _error$response6;\n  const errorContext = {\n    url: (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url,\n    method: (_error$config2 = error.config) === null || _error$config2 === void 0 ? void 0 : _error$config2.method,\n    status: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status,\n    statusText: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.statusText,\n    responseData: (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data,\n    requestData: (_error$config3 = error.config) === null || _error$config3 === void 0 ? void 0 : _error$config3.data,\n    headers: (_error$config4 = error.config) === null || _error$config4 === void 0 ? void 0 : _error$config4.headers\n  };\n  if (error.response) {\n    // Server responded with error status\n    debug('API Error Response:', errorContext);\n\n    // Handle specific status codes\n    if (error.response.status === 401) {\n      // Handle unauthorized (token expired, etc.)\n      debug('Authentication error - redirecting to login');\n      // You might want to redirect to login or refresh token here\n    } else if (error.response.status === 403) {\n      debug('Forbidden - insufficient permissions');\n    } else if (error.response.status === 404) {\n      debug('Resource not found');\n    } else if (error.response.status >= 500) {\n      debug('Server error occurred');\n    }\n  } else if (error.request) {\n    // Request was made but no response received\n    debug('No response received:', {\n      ...errorContext,\n      message: 'No response from server',\n      code: error.code\n    });\n  } else {\n    // Request setup error\n    debug('Request setup error:', {\n      ...errorContext,\n      message: error.message,\n      stack: error.stack\n    });\n  }\n\n  // Add additional context to the error\n  const enhancedError = new Error(error.message || 'API request failed');\n  enhancedError.isAxiosError = true;\n  enhancedError.config = error.config;\n  enhancedError.response = error.response;\n  enhancedError.request = error.request;\n  enhancedError.status = (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status;\n  enhancedError.statusText = (_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.statusText;\n  enhancedError.data = (_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : _error$response6.data;\n  return Promise.reject(enhancedError);\n});\n\n// Helper function to handle API errors consistently\nexport const handleApiError = (error, customMessage = 'An error occurred') => {\n  console.error(`${customMessage}:`, error);\n  let message = customMessage;\n  let details = null;\n  if (error.response) {\n    var _error$response$data, _error$response$data2;\n    // Server responded with error status\n    details = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || ((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.message);\n    message = details || `${error.response.status} ${error.response.statusText}`;\n  } else if (error.request) {\n    // Request was made but no response received\n    message = 'No response from server. Please check your connection.';\n  } else {\n    // Request setup error\n    details = error.message;\n  }\n  return {\n    error: true,\n    message,\n    details\n  };\n};\nexport default api;","map":{"version":3,"names":["axios","getAuth","debug","process","env","NODE_ENV","args","console","log","api","create","baseURL","REACT_APP_API_URL","withCredentials","timeout","headers","interceptors","request","use","config","_config$method","method","toUpperCase","url","auth","currentUser","token","getIdToken","Authorization","tokenError","error","Promise","reject","response","_response$config$meth","status","data","_error$config","_error$config2","_error$response","_error$response2","_error$response3","_error$config3","_error$config4","_error$response4","_error$response5","_error$response6","errorContext","statusText","responseData","requestData","message","code","stack","enhancedError","Error","isAxiosError","handleApiError","customMessage","details","_error$response$data","_error$response$data2"],"sources":["C:/WT-one-credit/src/services/api.js"],"sourcesContent":["import axios from 'axios';\nimport { getAuth } from 'firebase/auth';\n\n// Create a custom debug function that can be toggled\nconst debug = process.env.NODE_ENV === 'development' ? \n  (...args) => console.log('[API]', ...args) : \n  () => {};\n\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5002/api',\n  withCredentials: true,\n  timeout: 10000, // 10 second timeout\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n    'Cache-Control': 'no-cache',\n    'Pragma': 'no-cache',\n    'Expires': '0'\n  },\n});\n\n// Request interceptor for API calls\napi.interceptors.request.use(\n  async (config) => {\n    debug(`[${config.method?.toUpperCase()}]`, config.url);\n    \n    try {\n      const auth = getAuth();\n      if (auth.currentUser) {\n        try {\n          const token = await auth.currentUser.getIdToken(true);\n          if (token) {\n            config.headers.Authorization = `Bearer ${token}`;\n            debug('Added auth token to request');\n          }\n        } catch (tokenError) {\n          debug('Error getting auth token:', tokenError);\n          // Don't block the request if token refresh fails\n        }\n      } else {\n        debug('No current user, making unauthenticated request');\n      }\n      \n      return config;\n    } catch (error) {\n      debug('Request interceptor error:', error);\n      return Promise.reject(error);\n    }\n  },\n  (error) => {\n    debug('Request interceptor error (handler):', error);\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor for API calls\napi.interceptors.response.use(\n  (response) => {\n    debug(`[${response.status}] ${response.config.method?.toUpperCase()} ${response.config.url}`, {\n      data: response.data,\n      headers: response.headers\n    });\n    return response;\n  },\n  (error) => {\n    const errorContext = {\n      url: error.config?.url,\n      method: error.config?.method,\n      status: error.response?.status,\n      statusText: error.response?.statusText,\n      responseData: error.response?.data,\n      requestData: error.config?.data,\n      headers: error.config?.headers\n    };\n\n    if (error.response) {\n      // Server responded with error status\n      debug('API Error Response:', errorContext);\n      \n      // Handle specific status codes\n      if (error.response.status === 401) {\n        // Handle unauthorized (token expired, etc.)\n        debug('Authentication error - redirecting to login');\n        // You might want to redirect to login or refresh token here\n      } else if (error.response.status === 403) {\n        debug('Forbidden - insufficient permissions');\n      } else if (error.response.status === 404) {\n        debug('Resource not found');\n      } else if (error.response.status >= 500) {\n        debug('Server error occurred');\n      }\n      \n    } else if (error.request) {\n      // Request was made but no response received\n      debug('No response received:', {\n        ...errorContext,\n        message: 'No response from server',\n        code: error.code\n      });\n    } else {\n      // Request setup error\n      debug('Request setup error:', {\n        ...errorContext,\n        message: error.message,\n        stack: error.stack\n      });\n    }\n\n    // Add additional context to the error\n    const enhancedError = new Error(error.message || 'API request failed');\n    enhancedError.isAxiosError = true;\n    enhancedError.config = error.config;\n    enhancedError.response = error.response;\n    enhancedError.request = error.request;\n    enhancedError.status = error.response?.status;\n    enhancedError.statusText = error.response?.statusText;\n    enhancedError.data = error.response?.data;\n    \n    return Promise.reject(enhancedError);\n  }\n);\n\n// Helper function to handle API errors consistently\nexport const handleApiError = (error, customMessage = 'An error occurred') => {\n  console.error(`${customMessage}:`, error);\n  \n  let message = customMessage;\n  let details = null;\n  \n  if (error.response) {\n    // Server responded with error status\n    details = error.response.data?.error || error.response.data?.message;\n    message = details || `${error.response.status} ${error.response.statusText}`;\n  } else if (error.request) {\n    // Request was made but no response received\n    message = 'No response from server. Please check your connection.';\n  } else {\n    // Request setup error\n    details = error.message;\n  }\n  \n  return { error: true, message, details };\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}